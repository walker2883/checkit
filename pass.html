<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="content-type" />
  <title>WCAG CHECK IT</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script> -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap-theme.css">
  <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>
<body>
  <style>
    body {
      padding: 10px;
    }
    img {
      margin: auto;
      display: block;
    }
  </style>
  <div id="test" class="container"></div>
  <style>
    xmp {
      white-space: inherit;
      margin: 0px;
    }
    .table {
      width: 100%;
      word-wrap: break-word;
    }
    .gtp {
      float: right
    }
  </style>
  <script type="text/javascript">
    $.ajaxSetup({
      beforeSend: function(xhr) {
        if (xhr.overrideMimeType) {
          xhr.overrideMimeType("application/json");
        }
      }
    });
    $(document).ready(function() {
      var jqXHR = $.get("accessibility_report.json", {}, function(data) {
        var dataOut;
        var dataQuantity = 0;
        var dataIndex = 0;
        var dataNames = [];
        var dataIssues = [];
        var dataHeadings = [];
        var dataDescriptions = [];
        var dataNodes = [];
        var dataNid = [];
        var dataNids = [];
        var issue;
        var heading;
        var description;
        var element;
        var node;
        var sss;
        for (item in data) {
          dataNames[dataQuantity] = item;
          dataQuantity++;
        }
        dataOut += "<img src='./images/checkit.gif' />";
        dataOut += "<table class='table table-bordered table-hover table-condensed'>";
        for (nid in dataNames) {
          dataNid = dataNames[nid].replace("node_", "");
          dataIssues[nid] += dataNames[0][0].issue;
          // dataOut += dataNames[nid].[0];
          dataOut += "<tr class='warning'><td colspan='4'>" + dataNid + "<a class='btn btn-success gtp' href='/node/" + dataNid + "'>go to page</a></td></tr>";
          // for () {
            // for (issue in dataIssues) {
            dataIndex = 0;
            dataItem = data[dataNames[nid]][dataIndex];
            // console.log(sss);
            dataItem.rowClass = "";
            dataIssues[dataIndex] = dataItem.issue;
            dataHeadings[dataIndex] = dataItem.heading;
            dataDescriptions[dataIndex] = dataItem.description;
            dataNodes[dataIndex] = dataItem.element.node;
            if (dataHeadings[dataIndex] == "ERROR") { dataItem.rowClass = "danger"; }
            dataOut += "<tr class='" + dataItem.rowClass + "'>";
            dataOut += "<td class='heading " + dataHeadings[dataIndex] + "'>" + dataHeadings[dataIndex] + "</td>";
            dataOut += "<td class='issue'>" + dataIssues[dataIndex] + "</td>";
            dataOut += "<td class='description'>" + dataDescriptions[dataIndex] + "</td>";
            dataOut += "<td class='nodes'><code>" + dataNodes[dataIndex] + "</code></td>";
            dataOut += "</tr>";
            dataIndex++;
            // }
          // }
        }
        dataOut += "</table>";
        document.getElementById('test').innerHTML = dataOut;
        }).fail(function( jqxhr, textStatus, error ) {
          var err = textStatus + ', ' + error;
          console.log( "Request Failed: " + err);
        });

        // heading
        // description
        // issue
        // element.node
        // dataOut += data;
        // dataOut += dataNames[1];
        // dataOut += "<br />";
        // dataOut += dataQuantity;
        // dataOut += data.length;
        //   dataIssues[dataQuantity] = item[dataQuantity].issue;
        //   dataNodes[dataQuantity] = item;
        //   dataHeadings[dataQuantity] = item;
        //   dataDescriptions[dataQuantity] = item;




        // var output;
        // output = "<img src='./images/checkit.gif' />";
        // output += "<table class='table table-bordered table-hover table-condensed'>";
        // for (p in data) {
        //   var test = data[p];
        //   for (k in test) {
        //     output += "<tr class='warning'><td colspan='4'>" + k + "<a class='btn btn-success gtp' href='" + k + "'>go to page</a></td></tr>";
        //     for (b in test[k].length) {
        //       var wcagitem = test[k][b];
        //       output += (wcagitem);
        //       output += "<tr>";
        //       output += "<td>" + wcagitem.heading + "</td>";
        //       output += "<td class=description>" + wcagitem.description + "</td>";
        //       output += "<td> " + wcagitem.issue + "</td>";
        //       var markup = wcagitem.element.node;
        //       var start = "<xmp>";
        //       var end = "</xmp>";
        //       var whole = start + markup + end;
        //       output += "<td>" + whole + "</td>";
        //       output += "</tr>";
        //     }
        //   }
        // }
        // output += "</table>";
        // document.getElementById('test').innerHTML = output;
        // console.log(data.node_1[0].heading);
        // }).fail(function( jqxhr, textStatus, error ) {
        //   var err = textStatus + ', ' + error;
        //   console.log( "Request Failed: " + err);
        // });
    });
  </script>
</body>
</html>
