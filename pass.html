<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="content-type" />
  <title>WCAG CHECK IT</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script> -->
  <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap-theme.css">
  <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"> -->
</head>
<body>
  <style>
    body {
      padding: 10px;
    }
    img {
      margin: auto;
      display: block;
    }
  </style>
  <div id="test">
  </div>
  <style>
    xmp {
      white-space: inherit;
      margin: 0px;
    }
    .table {
      width: 960px;
      word-wrap: break-word;
    }
    .gtp {
      float: right
    }
  </style>
  <script type="text/javascript">
    $.ajaxSetup({
      beforeSend: function(xhr) {
        if (xhr.overrideMimeType) {
          xhr.overrideMimeType("application/json");
        }
      }
    });
    $(document).ready(function() {
      var jqXHR = $.get("accessibility_report.json", {}, function(data) {
        var output;
        console.log(data);
        output = "<img src='./images/checkit.gif' />";
        output += "<table class='table table-bordered table-hover table-condensed'>";
        for (p in data) {
          var test = data[p];
          for (k in test) {
            output += "<tr class='warning'><td colspan='4'>" + k + "<a class='btn btn-success gtp' href='" + k + "'>go to page</a></td></tr>";
            for (b = 0; b < test[k].length; b++) {
              var wcagitem = test[k][b];
              output += "<tr>";
              output += "<td>" + wcagitem.heading + "</td>";
              output += "<td class=description>" + wcagitem.description + "</td>";
              output += "<td> " + wcagitem.issue + "</td>";
              var markup = wcagitem.element.node;
              var start = "<xmp>";
              var end = "</xmp>";
              var whole = start + markup + end;
              output += "<td>" + whole + "</td>";
              output += "</tr>";
            }
          }
        }
        output += "</table>";
        document.getElementById('test').append = output;
        console.log(data);
      }).fail(function( jqxhr, textStatus, error ) {
                    var err = textStatus + ', ' + error;
                    console.log( "Request Failed: " + err);
              });
    });
  </script>
</body>
</html>
